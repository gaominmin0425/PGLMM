---
title: "my_vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{my_vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


```{r}
#library(PGLMM)
library(tidyverse)
# Load data
## return for bootstrap
Gopher = para_bootstrap(100,tortoise, tortoise_fit$beta[2])
## For plots
tortoise <- read.csv("~/Desktop/Asc/PGLMM/R/gopher_tortoise.csv")
tortoise = tortoise %>% mutate(Year2005 = ifelse(tortoise$year == "2005",1,0), Year2006 = ifelse(tortoise$year=="2006", 1,0))
tortoise_fit <- run_model(tortoise, "tortoise")
Sigmasq = tortoise_fit$sigmasq
## compute bootstrap standard error and confidence interval in terms of prev
Gopher %>% filter(term == "prev") %>% summarize(SD = sd(estimate),Lower95 = quantile(estimate, .025),Upper95 = quantile(estimate,.975))


#histogram 
#data of intercept
p1 <- Gopher %>% filter(term == "(Intercept)")%>%select("estimate") %>%
  ggplot(aes(x=estimate,y=..density..))+ 
  geom_histogram(bindwidth=30)+
  geom_density()+    #add density curve
  ggtitle("histogram of intercept")+
  geom_vline(xintercept = tortoise_fit$beta[1], colour="green")  #true mean
p1
library(ggplot2)
q1<- Gopher %>% filter(term == "(Intercept)")%>%select("estimate") %>%
  ggplot(aes(sample=estimate)) +
  geom_qq() +
  geom_qq_line()+
  labs(title="QQ plot of intercept")
q1
```
Histogram with density function,and true mean 
1. parameter normality holds.
2. the true mean(green line) is approximate at the center.
QQ plot
1. parameter normality holds since most of the data are around the line patter even there are some outliers.
```{r}
#put two plots togther
library(patchwork)
p1+q1
```


```{r}
#data of prev
p2 <- Gopher %>% filter(term == "prev")%>%select("estimate") %>%
  ggplot(aes(x = estimate,y=..density..)) +
  geom_histogram(bindwidth=30)+
  geom_density()+    #add density curve
  ggtitle("histogram of prev")+
  geom_vline(xintercept = tortoise_fit$beta[2], colour="green") #true mean
p2

q2 <- Gopher %>% filter(term == "prev")%>%select("estimate") %>%
  ggplot(aes(sample=estimate)) +
  geom_qq() +
  geom_qq_line()+
  labs(title="QQ plot of prev")
q2
```
Histogram with density function,and true mean 
1. parameter normality holds.
2. the true mean(green line) is approximate at the center.
QQ plot
1. parameter normality holds since most of the data are around the line patter even there are some outliers.

```{r}
#put two plots togther
library(patchwork)
p2+q2
```

```{r}
#data of factor(year)2005
p3 <- Gopher %>% filter(term == "factor(year)2005")%>%select("estimate") %>%
  ggplot(aes(x = estimate,y=..density..)) +
  geom_histogram(bindwidth=30)+
  geom_density()+     #add density curve
  ggtitle("histogram of factor(year)2005")+
  geom_vline(xintercept = tortoise_fit$beta[3], colour="green")  #true mean
p3

q3 <- Gopher %>% filter(term == "factor(year)2005")%>%select("estimate") %>%
  ggplot(aes(sample=estimate)) +
  geom_qq() +
  geom_qq_line()+
  labs(title=" QQ plot of factor(year)2005")
q3
```
Histogram with density function,and true mean 
1. parameter normality holds.
2. the true mean(green line) is approximate at the center(left side a lit).

QQ plot
1.parameter normality holds since most of the data are around the line patter even there are some outliers.

```{r}
#put two plots togther
library(patchwork)
p3+q3
```


```{r}
#data of factor(year)2006
p4 <- Gopher %>% filter(term == "factor(year)2006")%>%select("estimate") %>%
  ggplot(aes(x = estimate,y=..density..)) +
  geom_histogram(bindwidth=30)+
  geom_density()+     #add density curve
  ggtitle("histogram of factor(year)2006")+
  geom_vline(xintercept = tortoise_fit$beta[4], colour="green")  #true mean
p4

q4<- Gopher %>% filter(term == "factor(year)2006")%>%select("estimate") %>%
  ggplot(aes(sample=estimate)) +
  geom_qq() +
  geom_qq_line()+
  labs(title=" QQ plot of factor(year)2006")
q4
```
Histogram with density function,and true mean 
1. parameter normality holds.
2. the true mean(green line) is approximate at the center.

QQ plot
1. parameter normality holds since most of the data are around the line patter even there are some outliers.

```{r}
#put two plots togther
library(patchwork)
p4+q4
```



```{r}
#data of sd__(Intercept)
p5 <- Gopher %>% filter(term == "sd__(Intercept)")%>%select("estimate") %>%
  ggplot(aes(x = estimate,y=..density..)) +
  geom_histogram(bindwidth=30)+
  geom_density()+  #add density curve
  ggtitle("histogram of sd__(Intercept)")+
  geom_vline(xintercept =tortoise_fit$sigmasq, colour="green")   #true mean
p5
q5<- Gopher %>% filter(term == "sd__(Intercept)")%>%select("estimate") %>%
  ggplot(aes(sample=estimate)) +
  geom_qq() +
  geom_qq_line()+
  labs(title=" QQ plot of sd__(Intercept)")
q5
```
Histogram with density function and qq plot
1. sigmasq is 0. 

```{r}
#put two plots togther
library(patchwork)
p5+q5
```







